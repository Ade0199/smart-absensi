<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Smart Absensi GPS</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --bg:#0a0f1e;
  --glass:rgba(255,255,255,.08);
  --accent:#00fff7;
}
body{
  margin:0;
  font-family:Segoe UI, sans-serif;
  background:radial-gradient(circle at top,#111a3a,#000);
  color:#fff;
  overflow:hidden;
}
canvas{
  position:fixed;
  inset:0;
  z-index:0;
}
.container{
  position:relative;
  z-index:1;
  max-width:420px;
  margin:40px auto;
  padding:20px;
}
.card{
  background:var(--glass);
  backdrop-filter:blur(14px);
  border-radius:18px;
  padding:20px;
  box-shadow:0 0 40px rgba(0,255,247,.25);
  margin-bottom:20px;
}
h1{
  text-align:center;
  color:var(--accent);
}
button{
  width:100%;
  padding:14px;
  border-radius:12px;
  border:none;
  background:linear-gradient(135deg,#00fff7,#0077ff);
  font-weight:bold;
  cursor:pointer;
}
.log{
  font-size:14px;
  line-height:1.6;
}
</style>
</head>

<body>
<canvas id="bg"></canvas>

<div class="container">
  <div class="card">
    <h1>SMART ABSENSI</h1>
    <p id="time">‚è≥ Memuat waktu...</p>
    <p id="location">üìç Mengambil lokasi...</p>
    <button onclick="absen()">ABSEN SEKARANG</button>
  </div>

  <div class="card">
    <h3>Riwayat Absensi</h3>
    <div id="log" class="log"></div>
  </div>
</div>

<script>
// ===== WAKTU REALTIME =====
setInterval(()=>{
  document.getElementById("time").innerText =
    "üïí " + new Date().toLocaleString("id-ID");
},1000);

// ===== GPS + ALAMAT =====
let lokasi="Lokasi tidak diketahui";
let koordinat="";

navigator.geolocation.getCurrentPosition(async pos=>{
  const lat=pos.coords.latitude;
  const lon=pos.coords.longitude;
  koordinat=`${lat.toFixed(5)}, ${lon.toFixed(5)}`;

  try{
    const res=await fetch(
      `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}`
    );
    const data=await res.json();
    lokasi=data.display_name;
  }catch{
    lokasi="Gagal mengambil alamat";
  }

  document.getElementById("location").innerText="üìç "+lokasi;
},()=>{
  document.getElementById("location").innerText="‚ùå Izin lokasi ditolak";
});

// ===== ABSENSI =====
function absen(){
  const data=JSON.parse(localStorage.getItem("absensi")||"[]");
  data.unshift({
    waktu:new Date().toLocaleString("id-ID"),
    alamat:lokasi,
    koordinat:koordinat
  });
  localStorage.setItem("absensi",JSON.stringify(data));
  tampilkan();
  alert("‚úÖ Absensi berhasil disimpan");
}

// ===== TAMPILKAN DATA =====
function tampilkan(){
  const data=JSON.parse(localStorage.getItem("absensi")||"[]");
  document.getElementById("log").innerHTML=data.map(d=>`
    ‚Ä¢ ${d.waktu}<br>
    <small>${d.alamat}</small><br>
    <small>(${d.koordinat})</small>
    <hr>
  `).join("");
}
tampilkan();

// ===== ANIMASI PARTIKEL =====
const c=document.getElementById("bg");
const ctx=c.getContext("2d");
c.width=innerWidth;
c.height=innerHeight;

let p=Array.from({length:80},()=>({
  x:Math.random()*c.width,
  y:Math.random()*c.height,
  vx:(Math.random()-.5)*.6,
  vy:(Math.random()-.5)*.6,
  r:Math.random()*2+1
}));

function anim(){
  ctx.clearRect(0,0,c.width,c.height);
  p.forEach(o=>{
    o.x+=o.vx; o.y+=o.vy;
    if(o.x<0||o.x>c.width) o.vx*=-1;
    if(o.y<0||o.y>c.height) o.vy*=-1;
    ctx.beginPath();
    ctx.arc(o.x,o.y,o.r,0,Math.PI*2);
    ctx.fillStyle="#00fff7";
    ctx.fill();
  });
  requestAnimationFrame(anim);
}
anim();
</script>
</body>
</html>
